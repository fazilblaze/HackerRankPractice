Score:30|Diff:Med

SELECT HID, H.NAME FROM
(SELECT HID, COUNT(CID) NC FROM
(SELECT S.HACKER_ID HID, CID, SC FROM
(SELECT C.CHALLENGE_ID CID, D.SCORE SC
FROM CHALLENGES C, DIFFICULTY D
WHERE D.DIFFICULTY_LEVEL=C.DIFFICULTY_LEVEL)
INNER JOIN SUBMISSIONS S ON (CID=S.CHALLENGE_ID AND S.SCORE=SC))
GROUP BY HID
HAVING COUNT(CID)>1)
LEFT JOIN HACKERS H ON HID=H.HACKER_ID
ORDER BY NC DESC,HID;
