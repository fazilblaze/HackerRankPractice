Score:30|Diff:Med

SELECT HID,NAME,CNT FROM
(SELECT HID,NAME,CNT,COUNT(NAME) OVER(PARTITION BY CNT) CCNT FROM
(SELECT DISTINCT H.HACKER_ID HID,H.NAME NAME,COUNT(C.CHALLENGE_ID) OVER (PARTITION BY H.HACKER_ID) CNT
FROM HACKERS H
INNER JOIN CHALLENGES C ON C.HACKER_ID=H.HACKER_ID))
WHERE CNT=(SELECT MAX(CNT) FROM(SELECT HID,NAME,CNT,COUNT(NAME) OVER(PARTITION BY CNT) CCNT FROM(SELECT DISTINCT H.HACKER_ID HID,H.NAME NAME,COUNT(C.CHALLENGE_ID) OVER (PARTITION BY H.HACKER_ID) CNT FROM HACKERS H INNER JOIN CHALLENGES C ON C.HACKER_ID=H.HACKER_ID))) OR CCNT=(SELECT MIN(CCNT) FROM(SELECT HID,NAME,CNT,COUNT(NAME) OVER(PARTITION BY CNT) CCNT FROM(SELECT DISTINCT H.HACKER_ID HID,H.NAME NAME,COUNT(C.CHALLENGE_ID) OVER (PARTITION BY H.HACKER_ID) CNT FROM HACKERS H INNER JOIN CHALLENGES C ON C.HACKER_ID=H.HACKER_ID)))
ORDER BY CNT DESC,HID;
